!function e(t,s,a){function i(r,c){if(!s[r]){if(!t[r]){var o="function"==typeof require&&require;if(!c&&o)return o(r,!0);if(n)return n(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var l=s[r]={exports:{}};t[r][0].call(l.exports,function(e){var s=t[r][1][e];return i(s?s:e)},l,l.exports,e,t,s,a)}return s[r].exports}for(var n="function"==typeof require&&require,r=0;r<a.length;r++)i(a[r]);return i}({1:[function(e,t,s){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),s=t.exec(location.search);return null===s?"":decodeURIComponent(s[1].replace(/\+/g," "))}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},r=e("react"),c=a(r),o=["turquoise","emerald","peter","asphalt","green","sunflower","belize","alizarin"],u="/api",l=document.querySelector("html").getAttribute("x-token"),d=c["default"].createClass({displayName:"YoMyPopcornApp",getInitialState:function(){return{activeScreen:this.getScreenNameFromURL(),userName:this.getUsernameFromURL()}},getScreenNameFromURL:function(){return"shows"===location.pathname.replace("/","")?"shows":"feed"},setFeedActive:function(){this.setState({activeScreen:"feed"})},setShowsActive:function(){this.setState({activeScreen:"shows"})},getUsernameFromURL:function(){return i("username")||"crap_unknown_username"},render:function(){var e="feed"==this.state.activeScreen,t=e?"is-active tab":"tab",s=e?"tab":"is-active tab",a=e?c["default"].createElement(h,{userName:this.state.userName}):c["default"].createElement(f,{userName:this.state.userName});return c["default"].createElement("div",null,c["default"].createElement("div",{className:"tabs"},c["default"].createElement("div",{className:t,onClick:this.setFeedActive},"Feed"),c["default"].createElement("div",{className:s,onClick:this.setShowsActive},"Shows")),a)}}),h=c["default"].createClass({displayName:"Feed",getInitialState:function(){return{feed:[]}},componentDidMount:function(){$.get(u+"/users/"+this.props.userName+"/feed?token="+l).then(function(e){this.setState({feed:e})}.bind(this))},render:function(){var e=this.state.feed.map(function(e){return c["default"].createElement(m,n({},e,{key:e.imdb_id}))}),t=null;return 0===e.length&&(t=c["default"].createElement("div",{className:"empty-state"},"Nothing here yet...")),c["default"].createElement("div",null,t||e)}}),m=c["default"].createClass({displayName:"FeedItem",render:function(){var e={backgroundImage:"url("+this.props.poster+")"},t=moment(1e3*this.props.first_aired).fromNow();return c["default"].createElement("div",{className:"feed-item"},c["default"].createElement("div",{className:"feed-item-header emerald"},t),c["default"].createElement("div",{className:"feed-item-body",style:e},c["default"].createElement("div",{className:"shadow"},c["default"].createElement("div",{className:"title"},this.props.title))),c["default"].createElement("div",{className:"feed-item-footer emerald"},"Season ",this.props.season,", Episode ",this.props.episode))}}),f=c["default"].createClass({displayName:"Shows",getInitialState:function(){return{isSearching:!1,userName:this.props.userName,subscribedShows:[],shows:[]}},componentDidMount:function(){$.getJSON(u+"/shows?compact=1").then(function(e){this.setState({shows:e})}.bind(this)),$.getJSON(u+"/users/"+this.state.userName+"/shows?token="+l+"&compact=1").then(function(e){this.setState({subscribedShows:e})}.bind(this))},setSearchActive:function(){this.setState({isSearching:!0})},setSearchInactive:function(){this.setState({isSearching:!1})},addSubscription:function(e){var t=(this.state.subscribedShows.push(e),[u,"/users/",this.state.userName,"/shows?token=",l].join(""));$.ajax({type:"POST",url:t,data:{imdb_id:e.imdb_id},success:function(){},dataType:"json"}),this.setSearchInactive()},removeSubscription:function(e){var t=this.state.subscribedShows.filter(function(t){return t.imdb_id!==e.imdb_id});this.setState({subscribedShows:t});var s=[u,"/users/",this.state.userName,"/shows/",e.imdb_id,"?token=",l].join("");$.ajax({type:"DELETE",url:s,data:{},success:function(){},dataType:"json"})},render:function(){var e=this.state.subscribedShows.map(function(e){return e.isSubscribed=!0,e}),t=this.state.isSearching?c["default"].createElement(p,{shows:this.state.shows,onSearch:this.search,onCancel:this.setSearchInactive,onAddSubscription:this.addSubscription,onRemoveSubscription:this.removeSubscription}):c["default"].createElement(b,{shows:e,onAddClicked:this.setSearchActive,onAddSubscription:this.addSubscription,onRemoveSubscription:this.removeSubscription});return c["default"].createElement("div",null,t)}}),p=c["default"].createClass({displayName:"Search",getInitialState:function(){return{searchValue:null}},searchInputDidChange:function(){var e=c["default"].findDOMNode(this.refs.searchInput),t=e.value;this.setState({searchValue:t})},componentDidMount:function(){var e=c["default"].findDOMNode(this.refs.searchInput);$(e).focus(),window.scrollTo&&window.scrollTo(0,0)},render:function(){var e=this.props.shows.filter(function(e){var t=(this.state.searchValue||"").toLowerCase(),s=e.title||"";return-1!==s.toLowerCase().indexOf(t)}.bind(this)),t=e.map(function(e){return c["default"].createElement(S,n({},e,{isSubscribed:!1,onBtnUnsubscribe:this.props.onRemoveSubscription,onBtnSubscribe:this.props.onAddSubscription,key:e.imdb_id}))}.bind(this)),s=c["default"].createElement("div",{className:"search-cancel",onClick:this.props.onCancel},"Ã—"),a=null;return 0===t.length&&(a=c["default"].createElement("div",{className:"empty-state"},"Uhm..shows are still loading...")),c["default"].createElement("div",null,c["default"].createElement("div",{className:"search-input"},s,c["default"].createElement("input",{ref:"searchInput",className:"input-search",type:"search",onKeyUp:this.searchInputDidChange,placeholder:"Search shows"})),a||t)}}),b=c["default"].createClass({displayName:"Subscriptions",render:function(){var e=this.props.shows.map(function(e){var t,s="color:"+e.imdb_id,a=localStorage.getItem(s);return a?t=a:(t=o.shift(),o.push(t),localStorage.setItem(s,t)),c["default"].createElement(S,n({},e,{className:t,isSubscribed:!0,onBtnUnsubscribe:this.props.onRemoveSubscription,onBtnSubscribe:this.props.onAddSubscription,key:e.imdb_id}))}.bind(this)),t=null;0===e.length&&(t=c["default"].createElement("div",{className:"empty-state"},"Get started by adding your favorite shows. Tap below!"));var s=c["default"].addons.CSSTransitionGroup,a=0===e.length?"+ Add your first show":"+ Add more shows";return c["default"].createElement("div",null,c["default"].createElement(s,{transitionName:"list-item-remove"},t||e),c["default"].createElement("div",{className:"list-btn list-item",onClick:this.props.onAddClicked},a))}}),S=c["default"].createClass({displayName:"ListItem",getInitialState:function(){return{isSubscribed:this.props.isSubscribed}},handleBtnClick:function(){this.state.isSubscribed?this.props.onBtnUnsubscribe(this.props):this.props.onBtnSubscribe(this.props),this.setState({isSubscribed:!this.state.isSubscribed})},render:function(){var e=["list-item",this.props.className,this.props.className?"no-border":""].join(" "),t=this.state.isSubscribed?c["default"].createElement("div",{className:"btn",onClick:this.handleBtnClick},"Unsubscribe"):c["default"].createElement("div",{className:"btn",onClick:this.handleBtnClick},"Subscribe");return c["default"].createElement("div",{className:e},c["default"].createElement("div",{className:"list-item-title"},this.props.title),c["default"].createElement("div",{className:"list-item-end"},t))}});c["default"].render(c["default"].createElement(d,null),document.getElementById("app"))},{react:"react"}]},{},[1]);